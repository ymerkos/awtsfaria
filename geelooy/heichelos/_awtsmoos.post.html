<!--B"H-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intense Post Viewer</title>
    <link rel="stylesheet" href="/heichelos/new-style.css" type="text/css">

    <link rel="stylesheet" href="/style/home/main.css">
</head>

<body>
    
    <div class="all">
        <?<script> return $a("nav/header.html") 
        </script>?>
 <div class="main">
<div class="post-view">
    
   

    

    <div class="container">
        <div class="post">
            <div class="post-header">
                
                <div class="post-title">
                   <?Awtsmoos
                        return post.title
                    ?>
                </div>
                <div class="post-details">

                    <div class="tl post-author"><div class="label">Author:</div>
                    <div class="value"><a href="/@<?Awtsmoos
                        return alias.id    
                    ?>"><?Awtsmoos
                        return alias.name
                    ?></a></div></div>
                    <div class="tl post-heichel-name"><div class="label">Heichel Name:</div>
                    <div class="value"><a href="/heichelos/<?Awtsmoos
                        return post.heichel.id
                    ?>"><?Awtsmoos
                        return post.heichel.name
                    ?></a></div></div>
                    <?<script>
                        var sr = $_GET.seriesParent;
                        try {
                            var bp = $_GET.basepath;
                            
                            var seriesDetails = await fetchAwtsmoos(
                                `/api/social/heichelos/${
                                    post.heichel.id
                                }/series/${
                                    sr
                                }/`
                            );
                            sr = seriesDetails
                          
                            
                            return /*html*/`
                                <div class="tl post-parent-series">
                                    <div class="label">Part of Series:</div>
                                    <div class="value"><a href="/heichelos/${
                                        post.heichel.id   
                                    }/#?series=${
                                        sr.id
                                    }&path=${
                                        encodeURIComponent(
                                            $_GET.path
                                        )
                                    }">${sr.prateem.name}</a>
                                </div>
                                </div>
                            `
                        } catch(e){
                            console.log(e)
                        }
                        return "ASDF"
                    </script>?>
                    <div class="settings"> <!-- Controls for Text Size -->
                        <div class="controls">
                            <button onclick="adjustFontSize('increase')" class="button secondary">Increase Text Size</button>
                            <button onclick="adjustFontSize('decrease')" class="button secondary">Decrease Text Size</button>
                        </div>
                    </div>
                </div>
                
                
                    
            </div>
            
            
            <div id="postFrame" class="post-frame">
                <?Awtsmoos
                    return post.content
                ?>
            </div>
            
            <?<script>
                    var html = "";
                   // var cur =  parseInt($_GET.currentIndex);
                    var myID = post.id;
                    var sr = $_GET.seriesParent;
                
                    var posts = await fetchAwtsmoos(
                        `/api/social/heichelos/${
                            post.heichel.id
                        }/series/${
                            sr
                        }/posts`
                    );
                    var cur = posts.indexOf(myID);
                    var length = posts.length;
                    
                    var hasPrevious = cur > 0;
                    var hasNext = cur < length - 1;
                    var sr = $_GET.seriesParent;
                    
                    html +=/*html*/`
                        <div class="nav">
                    `

                    html+= /*html*/`
                        <div class="controls">${
                            cur + 1
                        } of ${
                            length
                        }    
                        </div>
                    `;
                    var last = encodeURIComponent(posts[cur-1]);
                    if(hasPrevious) {
                        html += /*html*/
                        `<a id="last" class="nav button primary" href="${last}">Previous</a>`
                    }

                    if(hasNext) {
                        var next = encodeURIComponent(posts[cur+1]);
                        html += /*html*/
                        `<a id="next" class="nav button primary"  href="${next}">Next</a>`
                    }

                    html += `</div>`;

                    html += /*html*/`
                        <script>

                            if(window.next) {
                                next.href = next.href+"?"
                                +(new URLSearchParams({
                                    currentIndex: "${cur+1}",
                                    path: "${$_GET.path}",
                                    seriesParent: "${$_GET.seriesParent}"
                                }));
                            }

                            if(window.last) {
                                last.href = last.href+"?"
                                    +(new URLSearchParams({
                                    currentIndex: "${cur-1}",
                                    path: "${$_GET.path}",
                                    seriesParent: "${$_GET.seriesParent}"
                                }));
                            }
                        </script>
                    `
                    return html;
                    
                
                
            </script>?>
            <script>
                 
                console.log("B\"H")
                
                var MAX_FONT_SIZE = 45;  // Define the max font size
                var MIN_FONT_SIZE = 10;  // Define the min font size
                var FONT_SIZE_INCREMENT = 2; // Define the size increment
                var postElement;
                function adjustFontSize(action) {
                    if(!postElement)
                        postElement = document.querySelector('.content');
                    let currentFontSize = window.getComputedStyle(postElement, null).getPropertyValue('font-size');
                    currentFontSize = parseFloat(currentFontSize);
                
                    if(action =='increase' && currentFontSize < MAX_FONT_SIZE) {
                        postElement.style.fontSize = (currentFontSize + FONT_SIZE_INCREMENT) + 'px';
                    } else if(action === 'decrease' && currentFontSize > MIN_FONT_SIZE) {
                        postElement.style.fontSize = (currentFontSize - FONT_SIZE_INCREMENT) + 'px';
                    }
        
                    localStorage.currentFontSize = currentFontSize;
                    sendSizeMessage()
                }
            
            
        

            </script>

    
        </div>
    </div>

    </div>
    </div>
</div>
</body>

</html>
