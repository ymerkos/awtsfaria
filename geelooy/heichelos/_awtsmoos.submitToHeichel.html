<!--B"H-->
<?Awtsmoos
    return await getT("bh.html")
  ?>
<style>


/* Base Styles for the Submit Post Section */
.submit-post {
  background: linear-gradient(135deg, #16222A, #3A6073); /* Dynamic Gradient Background */
  color: #FFF;
  padding: 20px;
  margin: 15px;
  font-size:24px;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* Subtle Box Shadow for Depth */
  font-family: 'Helvetica Neue', sans-serif; /* Modern Font */
}

/* Header within the Submit Post Section */
.submit-post h2 {
  margin-top: 0;
  text-shadow: 1px 1px 3px #333; /* Text Shadow for Emphasis */
  font-size: 1.5em; /* Responsive Font Size */
}

/* Flexbox Layout for the Form */
.submit-form {
  display: flex;
  flex-direction: column;
  gap: 15px; /* Consistent Gap Between Form Elements */
}

/* Unified Styling for Input, Textarea, Button, and Select Elements */
.submit-form input,
.submit-form textarea,
.submit-form button,
.submit-form select {
  padding: 15px;
  border-radius: 6px; /* Rounded Corners */
  border: 1px solid #e0e0e0;
  transition: all 0.3s ease-in-out; /* Smooth Transition for Interactive Elements */
}

/* Hover and Focus States for Inputs and Textarea */
.submit-form input:hover,
.submit-form input:focus,
.submit-form textarea:hover,
.submit-form textarea:focus {
  outline: none;
  border-color: #3498db; /* Highlight Color on Hover or Focus */
  box-shadow: 0 0 5px rgba(52, 152, 219, 0.5); /* Subtle Glow Effect */
}

/* Button Styling */
.submit-form button {
  background-color: #16a085; /* Flat UI Color */
  color: white;
  border: none;
  cursor: pointer;
  font-weight: bold;
  text-transform: uppercase; /* Uppercase Text for Emphasis */
  letter-spacing: 1px; /* Spaced Lettering for Readability */
}

/* Hover State for Button */
.submit-form button:hover {
  background-color: #1abc9c; /* Slightly Lighter Shade on Hover */
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15); /* Button Elevation on Hover */
}

/* Styling Required Select Element */
select:required:invalid {
  color: gray; /* Subtle Hint Color for Placeholder */
}

/* Custom Scrollbars for Enhanced Scrolling Experience */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #f1f1f1;
}

::-webkit-scrollbar-thumb {
  background: #888;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}

/* Media Query for Responsive Adjustments */
@media only screen and (max-width: 600px) {
  .submit-post, .submit-form {
    margin: 10px;
    padding: 15px;
  }

  .submit-form button {
    font-size: 0.9em; /* Adjust Font Size for Smaller Screens */
  }
}
</style>
<?Awtsmoos
//<script>
    
    if(!this.aliasIDs) {
        
        var bh = await getT("bh.html")
        olam.replace= /*html*/bh+`
            <br>
            <h4>You are not even logged in!
                <a href="/heichelos/${heichel}">Back to Heichel</a>
                <br>
                <a href="/login">Login</a>
                <br>
                <a href="/register">Create Account</a>
                </h4>
        `;
    }
//</script>
?>
<?Awtsmoos
var t = $_GET.type;
		
		if(t == "post" || t == "series") {
			$sd.type = t;
			$sd.ttitle = $sd.type[0]
			.toUpperCase() +
				$sd.type.substring(1);
			$sd.tdesc = $sd.type == "post" ? "content" 
			: "description";
		}
		var r = $_GET.returnURL;
		if(r) {
			return `<a class="r" href=${
				r
			}>Back to previous</a>`
		}
		
	?>
<script>
	//<?Awtsmoos
	return `var heichel=${
		JSON.stringify(heichel)

		}`;

	//?>

</script>
<div class="submit-post">
    
    <h2>Submit Your <?Awtsmoos return $sd.ttitle
	?></h2>
    <form class="submit-form" 
    id="formidable"
    
    method="POST">
      <select name="aliasId" required>
        <option value="">Select your alias</option>
        <?Awtsmoos
            //<script>
                var html = ""
                aliasIDs.forEach(w=> {
                    html += `<option value="${w.id}">
                        ${w.name}
                    </option>`
                })
                return html;
            //</script>
        ?>
      </select>
      <input type="text" placeholder="<?Awtsmoos return $sd.ttitle ?> Title" name="title" required>
      <textarea placeholder="Write your <?Awtsmoos return $sd.type ?> <?Awtsmoos
			return $sd.tdesc
		?> here..." name="<?Awtsmoos return $sd.tdesc ?>" required></textarea>
      <input type="hidden" name="heichel" value="<?Awtsmoos
      return heichel
      ?>">
      <?Awtsmoos
        var a=this.series;
        if(!a) return "";
        var h="";
        var sr=await fetchAwtsmoos(
        `/api/social/heichelos/${
        heichel

        }/series/${
        series

        }`

        );
        if(sr && !sr.error) {
        return "Adding to series: "+sr.name+
        /*html*/`<input type="hidden"
        name="seriesId" value="${series}">`;

        }
        

      ?>
        <br>
      <button type="submit">Submit Post</button>
    </form>
  </div>

  <script>
    formidable.action=`/api/social/heichelos/${
	    heichel.id
	}/posts`;
    formidable.onsubmit = submitForm;
    // This function will be called when you want to submit the form.
    function submitForm(event) {
    // Prevent the default form submission via the browser.
    event.preventDefault();

    // Get the form element (assuming the form has an id "myForm").
    const form = formidable

      
  // Create a URLSearchParams object.
  const params = new URLSearchParams();

    // For each form element, add its name and value to the params.
    Array.from(form.elements).forEach(element => {
    if (element.name && !element.disabled) {
        // Check if it's a checkbox/radio and if it's checked.
        if ((element.type !== 'checkbox' && element.type !== 'radio') || element.checked) {
        params.append(element.name, element.value);
        }
    }
    });

    // Use the fetch API to submit the form data.
    fetch(form.action, {
    method: 'POST',
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: params
    })
    .then(response => {
        // Handle the response here. For example, you could convert it to JSON.
        if (!response.ok) {
        throw new Error('Network response was not ok ' + response.statusText);
        }
        return response.json(); // or .text() if the response is text and not JSON
    })
    .then(data => {
        if(data.error) {
            alert("There was a problem: "+JSON.stringify(data)+
		 params)
            return
        }
        alert("You just submitted the new entry: " + data.title);
        <?Awtsmoos 
            return "var heichel='"+heichel+"'"; 
        ?>
        location.href="/heichelos/"+heichel;
        // Handle the data from the response.
        console.log('Success:', data);
    })
    .catch((error) => {
        // Handle any errors here.
	    
        console.error('Error:', error);
    });
    }

  </script>
