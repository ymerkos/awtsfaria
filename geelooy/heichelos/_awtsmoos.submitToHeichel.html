<!--B"H-->
<?Awtsmoos
    return await getT("bh.html")
  ?>
<style>


 textarea:focus {
  outline: none;
  border-color: #3498db; /* Highlight Color on Hover or Focus */
  box-shadow: 0 0 5px rgba(52, 152, 219, 0.5); /* Subtle Glow Effect */
}
/* Custom Scrollbar Styles */
::-webkit-scrollbar {
    width: 12px; /* Increased width for better visibility */
}

::-webkit-scrollbar-track {
    background: #e2e2e2; /* Lighter track color for a modern look */
}

::-webkit-scrollbar-thumb {
    background: #666; /* Darker thumb for contrast */
    border-radius: 6px; /* Rounded corners for the thumb */
}

::-webkit-scrollbar-thumb:hover {
    background: #444; /* Darker color on hover for better interaction */
}

/* Base Styles for Better Readability */
body {
    font-size: 18px; /* Larger base font-size for better readability */
    line-height: 1.6; /* Improved line spacing for readability */
    color: #333; /* Darker text for better contrast */
    font-family: Arial, sans-serif; /* A clean, modern font */
}

/* Enhanced Form and Button Styles */
.submit-post, .submit-form {
    margin: 20px;
    padding: 20px;
    border: 1px solid #ccc; /* Subtle border for definition */
    border-radius: 8px; /* Rounded corners */
    background-color: #f9f9f9; /* Light background for the form */
}

.submit-form button {
    font-size: 1.1em; /* Larger font size for better readability */
    padding: 10px 15px; /* More padding for a larger, more clickable area */
    background-color: #007bff; /* Eye-catching button color */
    color: white; /* Contrast color for button text */
    border: none; /* Remove default border */
    border-radius: 5px; /* Rounded corners for the button */
    cursor: pointer; /* Cursor change to indicate clickable */
}

.submit-form button:hover {
    background-color: #0056b3; /* Darker shade on hover for interaction feedback */
}

/* Responsive Adjustments */
@media only screen and (max-width: 600px) {
    .submit-post, .submit-form {
        margin: 15px;
        padding: 15px;
    }

    .submit-form button {
        font-size: 1em; /* Slightly larger font size for mobile */
    }

    /* Larger Text Area for Mobile */
    textarea {
        min-height: 200px; /* Larger default height */
        width: 100%; /* Full width to utilize screen space */
    }
}
</style>
<?Awtsmoos
//<script>
    
    if(!this.aliasIDs) {
        
        var bh = await getT("bh.html")
        olam.replace= /*html*/bh+`
            <br>
            <h4>You are not even logged in!
                <a href="/heichelos/${heichel}">Back to Heichel</a>
                <br>
                <a href="/login">Login</a>
                <br>
                <a href="/register">Create Account</a>
                </h4>
        `;
    }
//</script>
?>
<?Awtsmoos
var t = $_GET.type;
		
		if(t == "post" || t == "series") {
			$sd.type = t;
			$sd.ttitle = $sd.type[0]
			.toUpperCase() +
				$sd.type.substring(1);
			$sd.tdesc = $sd.type == "post" ? "content" 
			: "description";
		}
		var r = $_GET.returnURL;
		if(r) {
			return `<a class="r" href=${
				r
			}>Back to previous</a>

<script>
var returnURL="${r}";

</script>`
		}
		
	?>
<script>
	<?Awtsmoos
	return `
 var type="${$sd.type}";
 
 var heichelId="${
		
		heichel

		}"`;

	?>

</script>
<div class="submit-post">
    
    <h2>Submit Your <?Awtsmoos return $sd.ttitle
	?></h2>
    <form class="submit-form" 
    id="formidable"
    
    method="POST">
      <select name="aliasId" required>
        <option value="">Select your alias</option>
        <?Awtsmoos
            //<script>
                var html = ""
                aliasIDs.forEach(w=> {
                    html += `<option value="${w.id}">
                        ${w.name}
                    </option>`
                })
                return html;
            //</script>
        ?>
      </select>
      <input type="text" placeholder="<?Awtsmoos return $sd.ttitle ?> Title" name="title" required>
      <textarea placeholder="Write your <?Awtsmoos return $sd.type ?> <?Awtsmoos
			return $sd.tdesc
		?> here..." name="<?Awtsmoos return $sd.tdesc ?>" required></textarea>
      <input type="hidden" name="heichel" value="<?Awtsmoos
      return heichel
      ?>">
      <?Awtsmoos
        var a=this.series;
        if(!a) return "";
        var h="";
        var sr=await fetchAwtsmoos(
        `/api/social/heichelos/${
        heichel

        }/series/${
        series

        }`

        );
        if(sr && !sr.error) {
        return "Adding to series: "+sr.prateem.name+
        /*html*/`<input type="hidden"
        name="parentSeriesId" value="${series}">`;

        }
        

      ?>
        <br>
      <button type="submit">Submit Post</button>
    </form>
  </div>

  <script>
    var n=type=="post"?"posts":
	    "addNewSeries"

    formidable.action=`/api/social/heichelos/${
	    heichelId
	}/${n}`;
    formidable.onsubmit = submitForm;
    // This function will be called when you want to submit the form.
    function submitForm(event) {
	
    // Prevent the default form submission via the browser.
    event.preventDefault();

    // Get the form element (assuming the form has an id "myForm").
    const form = formidable

      
  // Create a URLSearchParams object.
  const params = new URLSearchParams();

    // For each form element, add its name and value to the params.
    Array.from(form.elements).forEach(element => {
    if (element.name && !element.disabled) {
        // Check if it's a checkbox/radio and if it's checked.
        if ((element.type !== 'checkbox' && element.type !== 'radio') || element.checked) {
        params.append(element.name, element.value);
        }
    }
    });
	    

    // Use the fetch API to submit the form data.
    fetch(form.action, {
    method: 'POST',
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: params
    })
    .then(response => {
	    
        // Handle the response here. For example, you could convert it to JSON.
        if (!response.ok) {
        throw new Error('Network response was not ok ' + response.statusText);
        }
        return response.json(); // or .text() if the response is text and not JSON
    })
    .then(data => {
        if(data.error) {
            alert("There was a problem: "+JSON.stringify(data)+
		 params)
            return
        }
	var t=type="post"?data.title:
		data.prateem?data.prateem.name:
		"Couldn't get name"
        alert("You just submitted the new entry ");
        
        location.href=
	  returnURL;
        // Handle the data from the response.
        console.log('Success:', data);
    })
    .catch((error) => {
        // Handle any errors here.
	    
        console.error('Error:', error);
    });
    }

  </script>
