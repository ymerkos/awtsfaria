<!--B"H-->

<?Awtsmoos
    return await getT("bh.html")
  ?>
<style>


 textarea:focus {
  outline: none;
  border-color: #3498db; /* Highlight Color on Hover or Focus */
  box-shadow: 0 0 5px rgba(52, 152, 219, 0.5); /* Subtle Glow Effect */
}
/* Custom Scrollbar Styles */
::-webkit-scrollbar {
    width: 12px; /* Increased width for better visibility */
}

::-webkit-scrollbar-track {
    background: #e2e2e2; /* Lighter track color for a modern look */
}

::-webkit-scrollbar-thumb {
    background: #666; /* Darker thumb for contrast */
    border-radius: 6px; /* Rounded corners for the thumb */
}

::-webkit-scrollbar-thumb:hover {
    background: #444; /* Darker color on hover for better interaction */
}

/* Base Styles for Better Readability */
body {
    font-size: 18px; /* Larger base font-size for better readability */
    line-height: 1.6; /* Improved line spacing for readability */
    color: #333; /* Darker text for better contrast */
    font-family: Arial, sans-serif; /* A clean, modern font */
}

/* Enhanced Form and Button Styles */
.submit-post, .submit-form {
    margin: 20px;
    padding: 20px;
    border: 1px solid #ccc; /* Subtle border for definition */
    border-radius: 8px; /* Rounded corners */
    background-color: #f9f9f9; /* Light background for the form */
}

.submit-form button {
    font-size: 1.1em; /* Larger font size for better readability */
    padding: 10px 15px; /* More padding for a larger, more clickable area */
    background-color: #007bff; /* Eye-catching button color */
    color: white; /* Contrast color for button text */
    border: none; /* Remove default border */
    border-radius: 5px; /* Rounded corners for the button */
    cursor: pointer; /* Cursor change to indicate clickable */
}

.submit-form button:hover {
    background-color: #0056b3; /* Darker shade on hover for interaction feedback */
}

/* Responsive Adjustments */
@media only screen and (max-width: 600px) {
    .submit-post, .submit-form {
        margin: 15px;
        padding: 15px;
    }

    .submit-form button {
        font-size: 1em; /* Slightly larger font size for mobile */
        padding: 10px 15px; /* Maintain button padding */
    }

    /* Larger Text Area for Mobile */
    textarea {
        min-height: 150px; /* Adjusted height for mobile screens */
        width: 100%; /* Full width to utilize screen space */
        padding: 10px; /* Adjusted padding for mobile */
    }

    /* Adjustments for text inputs */
    .submit-form input[type="text"] {
        font-size: 16px; /* Reduced font size for text inputs */
        padding: 10px; /* Adjusted padding for text inputs */
        margin-top: 8px; /* Reduced margin for text inputs */
    }

    /* Adjustments for selects */
    .submit-form select {
        font-size: 16px; /* Reduced font size for selects */
        padding: 10px; /* Adjusted padding for selects */
        margin-top: 8px; /* Reduced margin for selects */
    }
}

.delete-btn {
    cursor: pointer;
    color: red;
    font-weight: bold;
    margin-left: 10px;
  }

/* Input and Textarea Styles Within .submit-form */
.submit-form input[type="text"], .submit-form textarea {
    font-size: 20px; /* Immensely large font size for text inputs and text area */
    width: 100%; /* Full width to maximize space */
    padding: 15px; /* Generous padding for a grand appearance */
    margin-top: 10px; /* Spacing above each input field */
    border: 2px solid #007bff; /* Bold border to outline the fields */
    border-radius: 10px; /* Pronounced rounded corners */
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
    background-color: #fff; /* Pure white background for maximum contrast */
    color: #333; /* Deep, dark text color for striking clarity */
    line-height: 1.5; /* Enhanced line height for readability */
}

/* Text Area Specific Styles for Even Greater Impact */
.submit-form textarea {
    min-height: 250px; /* Vast height for the text area */
    resize: vertical; /* Allow vertical resizing for flexibility */
}

/* Hover and Focus Enhancements for Inputs and Text Area */
.submit-form input[type="text"]:hover, .submit-form textarea:hover,
.submit-form input[type="text"]:focus, .submit-form textarea:focus {
    border-color: #0056b3; /* Deeper blue on hover and focus for interaction */
    box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.15); /* Intensified shadow for focus and hover */
}

/* Responsive Adjustments for Text Inputs and Text Area */
@media only screen and (max-width: 600px) {
    .submit-form input[type="text"], .submit-form textarea {
        font-size: 18px; /* Slightly reduced font size for mobile, still maintaining grandeur */
        padding: 12px; /* Adjusted padding for mobile varraints */
    }

    .submit-form textarea {
        min-height: 200px; /* Adjusted height for mobile screens */
    }
}

/* Select Element Style Within .submit-form */
.submit-form select {
    font-size: 20px; /* Monumental font size for the select box */
    width: 100%; /* Utilize the full width for a commanding presence */
    padding: 15px 10px; /* Robust padding for a prominent look */
    margin-top: 10px; /* Adequate spacing above the select box */
    border: 2px solid #007bff; /* Strong, vivid border for definition */
    border-radius: 10px; /* Bold, rounded corners */
    background-color: #fff; /* Crisp, white background for stark contrast */
    color: #333; /* Deep, dark text for dramatic clarity */
    line-height: 1.5; /* Enhanced line height for ease of reading */
    appearance: none; /* Remove default browser styling */
    background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%23333%22%20stroke-width%3D%223%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpath%20d%3D%22M6%209l6%206%206-6%22/%3E%3C/svg%3E'); /* Custom dropdown arrow */
    background-repeat: no-repeat;
    background-position: right 10px center; /* Position for the custom arrow */
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); /* Soft shadow for depth */
}

/* Hover and Focus Enhancements for Select */
.submit-form select:hover,
.submit-form select:focus {
    border-color: #0056b3; /* Intensify the border color for interactive feedback */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2); /* Deeper shadow for a dynamic effect */
    background-color: #fafafa; /* Slightly lighter background for a subtle interactive cue */
}

/* Styles for Options in Select */
.submit-form select option {
    padding: 10px; /* Comfortable padding for each option */
    background-color: white; /* Ensure a consistent background for options */
    color: #333; /* Maintain readability with a strong text color */
}

/* Responsive Adjustments for Select Element on Mobile Devices */
@media only screen and (max-width: 600px) {
    .submit-form select {
        font-size: 18px; /* Slightly smaller font size, still ensuring impact */
        padding: 12px 8px; /* Adjust padding for better handling on smaller screens */
    }

    .submit-form select option {
        padding: 8px; /* Adjust option padding for consistency */
    }
}
</style>
<?Awtsmoos
//<script>
    
    if(!this.aliasIDs) {
        
        var bh = await getT("bh.html")
        olam.replace= /*html*/bh+`
            <br>
            <h4>You are not even logged in!
                <a href="/heichelos/${heichel}">Back to Heichel</a>
                <br>
                <a href="/login">Login</a>
                <br>
                <a href="/register">Create Account</a>
                </h4>
        `;
    }
//</script>
?>
<?Awtsmoos
//<script>
    
		if($$sd.returnURL) {
			return `<a class="r" href=${
                            $$sd.returnURL
                        }>Back to previous</a>

            <`+`script>
            var returnURL="${$$sd.returnURL}";

            </`+`script>`;
        }
	//</script>	
		
	?>
<script>
	//<?Awtsmoos
	return `

 var type="${$$sd.type}";
 
 var heichelId="${
		
		heichel

		}"
  var allInfo=${JSON.stringify($$sd)}
  `;

	//?>

</script>
<div class="submit-post">
    
    <h2><script awts>
        return $$sd.action == "edit"?"Edit"
            :"Submit"
    </script>?> Your <script awts> 
        return $$sd.ttitle+""
	</script>?></h2>
    <form action="<?Awtsmoos return $$sd.endpoint ?>" class="submit-form" 
    id="formidable"
    
    method="<?Awtsmoos return $$sd.method ?>">
      <label for="aliasS">Select the alias to select</label>
      <select name="aliasId" id="aliasS" required>
        <!--<option value="">Select your alias</option>-->
        <script awts>
                var html = ""
                aliasIDs.forEach(w=> {
                    html += `<option value="${w.id}">
                        ${w.name}
                    </option>`
                })
                return html;
        </script>?>
      </select>
      <script awts>
        $sd.placeholderTitle =  $$sd.ttitle+" Title";
        $sd.placeholderContent = `Write your ${
            $$sd.type
        } ${
            $$sd.tdesc
        } here..."`;

        return $$sd.current?`
        <scri`+`pt>
            var cur = ${
                JSON.stringify($$sd.current)
            }
        </script>

        `:""
        
      </script>?>
      <input type="text" id="titleM"
      placeholder="<?Awtsmoos return $sd.placeholderTitle ?>" name="title" required>
      <textarea id="contentM"
       placeholder="<?Awtsmoos return $sd.placeholderContent ?>" name="<?Awtsmoos return $$sd.tdesc ?>" required></textarea>
       <div id="sectionContainer">
        <!-- Sections will be dynamically added here -->
      </div>
      <button onclick="addSection()">Add New Section</button>

       <input type="hidden" name="heichel" value="<?Awtsmoos
      return heichel
      ?>">
      <?<script>
        var a=this.series;
        if(!a) return "";
        var h="";
        var sr=await fetchAwtsmoos(
            `/api/social/heichelos/${
            heichel

            }/series/${
            series

        }`

        );
        if(sr && !sr.error) {
            return "Adding to series: "+sr.prateem.name+
            /*html*/`<input type="hidden"
            name="parentSeriesId" value="${series}">`;

        }
        

        </script>?>
        <script awts>
            var ty = $$sd.type == "comment";
            var par = $$sd.parentType;
            var parId = $$sd.parentId;
            if(!ty || !par || parid) return "";
            return /*html*/`
                <!--<label for="postParent">Parent to add to:</label>-->
                <input type="hidden" name="parentType" value="${par}">
                <input type="hidden" name="parentId" value="${parId}">
            `
        </script>?>
        <br>
      <button type="submit">Submit <script awts>
        return $$sd.ttitle +""
      </script>?></button>
    </form>
  </div>

  <script>
    if(window.cur) {
	    if(cur.prateem) cur=cur.prateem
	   // alert(JSON.stringify(cur))
        titleM.value =  cur.name || cur.title;
        contentM.value = cur.content || cur.description
    }
    formidable.onsubmit = submitForm;
    // This function will be called when you want to submit the form.
    function submitForm(event) {
	
    // Prevent the default form submission via the browser.
    event.preventDefault();

    // Get the form element (assuming the form has an id "myForm").
    var form = formidable

      
  // Create a URLSearchParams object.
  var params = new URLSearchParams();

    // For each form element, add its name and value to the params.
    Array.from(form.elements).forEach(element => {
    if (element.name && !element.disabled) {
        // Check if it's a checkbox/radio and if it's checked.
        if ((element.type !== 'checkbox' && element.type !== 'radio') || element.checked) {
        params.append(element.name, element.value);
        }
    }
    });
	    

    // Use the fetch API to submit the form data.
    fetch(form.action, {
    method: form.getAttribute("method"),
    headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: params
    })
    .then(response => {
	    
        // Handle the response here. For example, you could convert it to JSON.
        if (!response.ok) {
        throw new Error('Network response was not ok ' + response.statusText);
        }
        return response.json(); // or .text() if the response is text and not JSON
    })
    .then(data => {
        if(data.error) {
            console.log("EROR?!",data,formidable.action)
            alert("There was a problem: "+JSON.stringify(data)+
		 //JSON.stringify(allInfo)
		 params.aliasId+ " "+aliasS.value + 
		  " endpoint "+form.action + " "+allInfo.endpoint
		)
            return
        }
	var t=type="post"?data.title:
		data.prateem?data.prateem.name:
		"Couldn't get name"
        alert("You just submitted the entry "+
	     JSON.stringify(data)
	     );
        
        location.href=
	  returnURL;
        // Handle the data from the response.
        console.log('Success:', data);
    })
    .catch((error) => {
        // Handle any errors here.
	    alert("issue "+error);
	    
        console.error('Error:', error);
    });
    }

    function addSection() {
        // Create a new div element for the section
        var section = document.createElement("div");
        section.contentEditable = true; // Allow inline editing
        section.classList.add("section"); // Add a class for styling

        // Create a delete button for the section
        var deleteBtn = document.createElement("span");
        deleteBtn.textContent = "Delete";
        deleteBtn.classList.add("delete-btn");
        // Add click event listener to delete button
        deleteBtn.onclick = function() {
            section.remove(); // Remove the section when delete button is clicked
        };

        // Append delete button to the section
        section.appendChild(deleteBtn);

        // Append the section to the sectionContainer
        document.getElementById("sectionContainer").appendChild(section);
    }

  </script>
